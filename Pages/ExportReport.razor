@page "/exportreport"
@using System.Diagnostics
@using QuestPDF.Drawing
@using QuestPDF.Fluent
@using QuestPDF

@inject IJSRuntime JS
@inject HttpClient Http

<PageTitle>Export Report</PageTitle>

<h1>Export Report</h1>

<p>Click the button to export your report.</p>

<button @onclick="ExportPDF">Export Report</button>

@code {

    async Task ExportPDF()
    {
        using var ms = new MemoryStream();
        var font = await Http.GetStreamAsync("assets/calibri.ttf");
        var bold = await Http.GetStreamAsync("assets/calibrib.ttf");
        var italic = await Http.GetStreamAsync("assets/calibrii.ttf");
        FontManager.RegisterFont(font);
        FontManager.RegisterFont(bold);
        FontManager.RegisterFont(italic);
        var document = new SoilReport();
        var fileBytes = document.GeneratePdf();

        await JS.InvokeVoidAsync("BlazorDownloadFile", "report.pdf", "application/pdf", fileBytes);
    }
}
